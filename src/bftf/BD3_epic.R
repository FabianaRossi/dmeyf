
#limpio la memoria
rm( list=ls() )  #remove all objects
gc()             #garbage collection

require("data.table")
require("Rcpp")
require("rlist")
require("yaml")

require("lightgbm")


#defino la carpeta donde trabajo
directory.root  <-  "~/buckets/b1/"  #Google Cloud
setwd( directory.root )


vector <- "ctrx_quarter
mcaja_ahorro
mtarjeta_visa_consumo
ctrx_quarter_min6
mcuentas_saldo
cpayroll_trx
ctarjeta_visa_transacciones
mpayroll_fabi
ctrx_quarter_avg3
mpasivos_margen
mpayroll
mcuenta_corriente_delta6
mcaja_ahorro_fabi
mprestamos_personales
mcaja_ahorro_avg3
mdescubierto_preacordado_tend6
mautoservicio
mv_status07_tend6
mprestamos_personales_min6
mv_status06_tend6_avg3
mcuenta_corriente_min6_delta4
mv_msaldopesos
mv_status04_delta6_avg6
mtarjeta_visa_consumo_delta5
mv_mpagominimo
cproductos_delta2
cproductos_delta1
mcuentas_saldo_min6_delta2
mpasivos_margen_avg3
mdescubierto_preacordado_tend6_avg6
ccomisiones_mantenimiento_delta1_avg6
ccaja_ahorro
mdescubierto_preacordado_tend6_avg3
mv_status04
mactivos_margen
cproductos
mcuentas_saldo_delta5
mv_status01
mv_msaldototal
mpagomiscuentas
cproductos_avg6_delta2_avg3
cproductos_delta3
mtarjeta_visa_consumo_delta6
mdescubierto_preacordado_delta2
mdescubierto_preacordado_delta1_avg6
mdescubierto_preacordado_tend6_avg6_avg3
mcuentas_saldo_min6_delta3
mv_status04_delta3
mv_status07_tend6_avg6_avg3
cproductos_delta1_avg3
mv_mpagominimo_avg3
mcaja_ahorro_delta1
mpasivos_margen_delta5
mv_status04_tend6
mtarjeta_master_consumo
mcuenta_corriente
cpayroll_trx_min6
mcaja_ahorro_dolares_delta1
mv_status07_tend6_avg6
mtransferencias_recibidas
mcuentas_saldo_min6_delta4
ctrx_quarter_delta1
mcomisiones_mantenimiento_delta1_avg6
mprestamos_personales_min6_delta3
mv_Finiciomora
Visa_mfinanciacion_limite
mcuentas_saldo_delta6
mv_status06_tend6
mprestamos_personales_avg3
Visa_status_max6
mprestamos_personales_delta3
mv_mpagospesos
foto_mes
ctarjeta_debito_transacciones
mv_fechaalta_delta2
cpayroll_trx_min6_delta2
tcallcenter_tend6
mv_cconsumos
mdescubierto_preacordado
mprestamos_personales_delta3_avg6
mcomisiones_mantenimiento_delta6
mv_fechaalta_tend6
mrentabilidad_max6_avg3
ccomisiones_mantenimiento_tend6
mpayroll_delta1_avg3
mtarjeta_visa_consumo_delta6_avg6
mdescubierto_preacordado_delta1
mprestamos_personales_delta1_avg3
ctransferencias_recibidas_avg6_lag2_lag3_lag4_avg3
mcuenta_debitos_automaticos_delta6
ctrx_quarter_min6_delta6_avg6_avg3
mcomisiones_mantenimiento_avg6_delta2
mcuentas_saldo_min6_delta6_avg3
mcuentas_saldo_delta4
ctrx_quarter_delta1_avg3
mpayroll_delta2
mactivos_margen_avg3
mprestamos_personales_delta2
mpayroll_delta6_avg6
cpayroll_trx_min6_avg3
Visa_fechaalta_tend6
mcuenta_debitos_automaticos
mcuentas_saldo_min6
ctransferencias_emitidas_max6_lag6_avg6
ctarjeta_visa_transacciones_min6_delta2_avg6
mes
mdescubierto_preacordado_delta1_tend6
Visa_mpagominimo_max6_tend6
chomebanking_transacciones_lag4_avg6
mactivos_margen_delta5
mv_status01_avg3
mpasivos_margen_lag1_avg3
ccaja_seguridad
mcomisiones_mantenimiento_max6
mcomisiones_mantenimiento_delta6_avg6
mplazo_fijo_dolares
cproductos_tend6_avg3
mcomisiones_delta1_delta3_tend6_avg3
chomebanking_transacciones_delta2
mpayroll_avg3
ctrx_quarter_min6_delta2
mpasivos_margen_max6
mpayroll_lag1_avg3
mprestamos_personales_tend6
mpasivos_margen_avg6
numero_de_cliente
mrentabilidad_max6_avg6
ctrx_quarter_delta2
mprestamos_personales_min6_avg3
ccallcenter_transacciones_tend6
ctarjeta_visa_transacciones_tend6_avg3
mtransferencias_recibidas_delta5
mcuentas_saldo_min6_delta5
ctarjeta_visa_transacciones_min6_delta2_avg3
cliente_edad
Visa_mpagospesos_max6_lag2_lag3_lag5_lag6_avg3
thomebanking
mplazo_fijo_dolares_delta6
mv_fultimo_cierre_avg6_delta2_lag3_delta4_tend6
ccaja_seguridad_avg6_avg3
ccomisiones_mantenimiento_delta1
ctarjeta_visa_transacciones_tend6
mrentabilidad_max6_avg6_avg3
Visa_msaldototal
mcomisiones_mantenimiento_avg6_delta3_lag4_avg6_avg3
ctransferencias_recibidas_avg6_lag2_lag3_lag4_avg6
mtarjeta_visa_consumo_min6_delta3
mvr_Master_mlimitecompra_delta6_avg3
mrentabilidad_max6
Master_mfinanciacion_limite
mcomisiones_mantenimiento_delta4
ctransferencias_recibidas_avg6_lag2_lag3_avg6_avg3
Visa_fultimo_cierre_avg6_delta3_avg3
Visa_mpagominimo_max6_delta2
ctrx_quarter_delta6_avg6
chomebanking_transacciones_max6
mttarjeta_visa_debitos_automaticos_avg6_delta2
ctrx_quarter_min6_delta4_tend6_avg3
ctrx_quarter_delta4
thomebanking_tend6
mactivos_margen_lag1
tcallcenter_avg6_delta2
mttarjeta_visa_debitos_automaticos_tend6_delta2
internet_avg6_lag3_lag4_lag6_avg6_avg3
mcomisiones_mantenimiento_delta1_delta6_avg6
mcuentas_saldo_delta3
mv_mpagominimo_avg6
mcuenta_corriente_min6_lag2_lag5_avg6
mcuentas_saldo_min6_delta6
chomebanking_transacciones_delta3
Visa_fechaalta
chomebanking_transacciones_avg6_lag2_lag3_lag4_lag5_delta6
Visa_mpagominimo_max6_delta5_avg6
ctarjeta_master_transacciones
mcuentas_saldo_tend6
cmobile_app_trx_max6
mcomisiones_otras_min6_lag2_lag5_lag6_avg6_avg3
mcomisiones_otras_min6_lag2_lag4_lag5_lag6_avg6
mcuentas_saldo_min6_delta6_avg6_avg3
ctrx_quarter_min6_delta5_avg6
cproductos_tend6
cpayroll_trx_min6_delta2_delta6_tend6
Visa_mpagominimo_delta1_delta2
mcuenta_corriente_min6_lag2_lag5_avg6_avg3
mvr_msaldopesos2
mtarjeta_master_consumo_delta5
mcomisiones_delta1_delta3_tend6
mcuentas_saldo_delta1
mprestamos_personales_delta6
mtarjeta_visa_consumo_min6_delta3_avg6
cmobile_app_trx_max6_delta3_delta4
mpasivos_margen_delta1_lag4
mprestamos_personales_min6_delta2_avg3
cmobile_app_trx_max6_delta3_delta4_avg6
mcomisiones_otras_min6_lag2_lag3_lag5_avg3
mcomisiones_min6_lag2_lag3_lag4_lag5_lag6
mtransferencias_emitidas_max6_avg3
mvr_mpagominimo_delta2_delta3
ccaja_seguridad_min6
tcallcenter_avg6_avg6_avg3
mactivos_margen_avg6_avg3
matm_max6_delta3_tend6
ccaja_ahorro_tend6_avg6_avg3
Visa_cconsumos_max6_lag2_lag3_lag4_delta6_avg6_avg3
mcomisiones_mantenimiento
chomebanking_transacciones_delta1_delta2
mcuenta_corriente_min6_lag2_avg6_avg3
Visa_cconsumos_avg6_delta3
ccaja_ahorro_avg3
Visa_mpagospesos_max6_lag6_avg6_avg3
mcomisiones_otras_min6_lag2_lag3_lag5_delta6
chomebanking_transacciones_max6_delta2_delta3_delta5_delta6
cpagomiscuentas_tend6_avg6
Master_mfinanciacion_limite_min6_lag2_lag3_lag6_avg3
mv_cconsumos_avg6_avg3
mcuentas_saldo_delta2
mcuentas_saldo_min6_delta2_delta6
mv_mpagominimo_max6_avg3
Master_mconsumospesos_tend6
mpasivos_margen_max6_tend6
mv_mpagominimo_min6
chomebanking_transacciones_avg6_lag2_lag3_lag4_lag5_lag6
mcuentas_saldo_delta1_avg6
mcuenta_corriente_delta3
mactivos_margen_delta4_lag5
mprestamos_personales_delta5
Master_mfinanciacion_limite_delta4_delta5
Visa_fultimo_cierre_avg6_delta3_avg6
mcomisiones_mantenimiento_tend6_avg3
ctrx_quarter_delta3
ccomisiones_mantenimiento_delta1_avg6_avg3
ctrx_quarter_min6_delta5_tend6
Master_mfinanciacion_limite_min6_lag2_lag3_lag6_avg6
mcomisiones_mantenimiento_delta5
Visa_fultimo_cierre_avg6_lag2_delta3
Visa_msaldototal_min6_lag2_delta3_lag5_tend6
ccajas_consultas_tend6
Visa_mpagospesos_max6_lag6_avg6
ccomisiones_otras_avg6_lag4_delta5_delta6_tend6_avg3
mcuentas_saldo_min6_lag4_delta6_avg6
mtransferencias_emitidas_max6
chomebanking_transacciones_delta1_delta2_lag5
mdescubierto_preacordado_delta1_avg6_avg3
mactivos_margen_delta2_avg3
tcallcenter_avg6_avg6
mrentabilidad_delta4_delta6_tend6
Visa_cconsumos_avg6_lag2_lag3_lag5_lag6_avg6_avg3
mactivos_margen_max6_lag3_delta4_lag5_avg6_avg3
mrentabilidad_annual_lag2_lag3
ctrx_quarter_delta2_avg6
mcomisiones_otras_min6_lag4_avg3
mactivos_margen_max6_lag6_avg3
chomebanking_transacciones_avg6_lag2_lag3_avg3
mactivos_margen_min6_delta2_tend6_avg3
mcomisiones_otras_min6_lag2_lag3_lag4_lag5_lag6
Visa_mpagospesos_max6_delta5
mv_fechaalta
ctrx_quarter_max6_lag3_lag4_lag5_lag6_avg6_avg3
ctransferencias_emitidas_avg6_lag2_lag3_avg3
chomebanking_transacciones_delta1_delta2_avg6
ctrx_quarter_min6_delta6
ctransferencias_recibidas_avg6_lag2_lag3_avg6
Visa_cconsumos_max6_lag2_lag3_delta4_delta6_avg6_avg3
mcomisiones_otras_min6_lag2_lag3_lag5
mv_mpagominimo_max6_lag5_delta6
thomebanking_avg6_avg3
mprestamos_personales_delta5_avg3
ctrx_quarter_max6_lag2_lag3_lag4_delta5_lag6_avg6_avg3
ctrx_quarter_max6_lag2_lag3_lag4_lag5_delta6_avg6
mcomisiones_tend6_delta5_avg6_avg3
Visa_cconsumos_avg6_lag3_avg6
ctrx_quarter_delta1_lag6_avg6
mv_fultimo_cierre_avg6_delta3_avg3
mcomisiones_mantenimiento_tend6
mpayroll_delta4
chomebanking_transacciones_max6_avg6_avg3
mpasivos_margen_max6_avg6
cpayroll_trx_min6_avg6
ctrx_quarter_delta6
mpasivos_margen_lag1_delta4_lag6_avg6_avg3
Visa_mpagospesos_max6_delta4
cmobile_app_trx_max6_lag6_avg6
mpayroll_delta3
Visa_mpagospesos_max6_lag2_lag3_lag4_lag5_lag6_avg6_avg3
ctarjeta_visa_transacciones_delta4
mactivos_margen_min6_tend6
ctarjeta_visa_transacciones_delta6
mrentabilidad_annual_delta2_delta6_tend6
mcuentas_saldo_min6_lag6
mrentabilidad_delta2_tend6_avg3
ctrx_quarter_max6_lag2_lag3_lag5_lag6_avg6
Master_mfinanciacion_limite_min6_lag2_lag3_lag4_lag5_lag6_tend6
cextraccion_autoservicio_tend6_lag5_lag6_avg3
cliente_edad_lag1_lag2_lag3_avg3
mtransferencias_recibidas_delta5_avg6_avg3
mcaja_ahorro_dolares_min6_delta2
mcuenta_corriente_min6_avg6_avg3
mrentabilidad_delta1_lag2_lag3_avg6
Visa_mpagospesos_max6_avg3
mrentabilidad_avg3
mcomisiones_otras_min6_lag2_lag3_lag5_delta6_avg3
chomebanking_transacciones_delta1_delta2_avg6_avg3
mv_fechaalta_tend6_tend6
mrentabilidad_min6
Visa_mpagominimo_max6_delta4
cliente_edad_avg6_lag2_lag3_avg6
mcuenta_corriente_min6_lag2_avg6
ctarjeta_visa_transacciones_delta6_avg6
ctransferencias_emitidas_avg6_lag2_lag3_lag6_avg6_avg3
cpayroll_trx_avg6_avg3
Visa_mpagospesos_max6
mrentabilidad_annual_delta2_lag6_avg3
mrentabilidad_annual_max6_lag2_lag3
mrentabilidad_annual_tend6_avg3
mcomisiones_otras_min6_lag2_lag3_lag5_tend6
ccomisiones_otras_avg6_delta6_avg6
chomebanking_transacciones_max6_avg6
Visa_fechaalta_lag4_lag5
ccaja_ahorro_delta6_avg6_avg3
mpasivos_margen_avg6_tend6
mcaja_ahorro_dolares_min6
ccuenta_debitos_automaticos_tend6
mtransferencias_recibidas_delta5_avg3
ctrx_quarter_min6_delta3
cmobile_app_trx_max6_delta6_avg6
mactivos_margen_lag1_lag4_delta6
mrentabilidad_max6_lag2_delta4_lag5_delta6_tend6
ctransferencias_emitidas_avg6_lag2_lag3_lag4_lag6_avg6
mv_mpagominimo_min6_avg3
mactivos_margen_delta1_lag3_lag4_avg3
mv_fechaalta_tend6_tend6_avg3
mcomisiones_otras_min6_delta4_avg6
Visa_mpagospesos_max6_lag2_lag3_lag4_lag5_lag6_avg3
Visa_Fvencimiento_lag2_avg6
mv_cconsumos_tend6_lag5_delta6_tend6
mcuenta_corriente_avg3
mvr_msaldopesos2_tend6
chomebanking_transacciones_min6_avg6_avg3
ccomisiones_otras_avg6_avg3
mcuenta_corriente_delta2
tcallcenter_tend6_tend6_avg3
mcuenta_corriente_avg6_delta2_tend6
mrentabilidad_max6_lag2
mrentabilidad
Master_fultimo_cierre_avg6
ccomisiones_otras_avg6_lag4_delta5_delta6_tend6
ctrx_quarter_min6_lag4_delta5_avg6_avg3
mpayroll_avg6_lag2_lag5_avg6_avg3
mcaja_ahorro_lag1
ccomisiones_otras_tend6_lag2_delta6_avg6
ctransferencias_recibidas_tend6_delta2_avg6_avg3
mactivos_margen_tend6_tend6
mv_fechaalta_min6_lag2_lag3_lag4_lag5_lag6
mvr_mpagominimo_avg6_lag2_lag3_delta4_delta5_delta6_avg6
mv_fechaalta_lag4_lag6
mcomisiones_mantenimiento_delta6_avg6_avg3
mv_cconsumos_delta4
mpasivos_margen_delta1
Visa_fultimo_cierre_avg6_delta5
ctrx_quarter_max6_lag2_lag3_lag4_lag5_delta6
Visa_mfinanciacion_limite_avg6_avg3
mcuentas_saldo_lag1
mcuenta_corriente_min6_lag2_delta6_avg6
mactivos_margen_min6_delta6_avg6
ctrx_quarter_max6_lag3_lag4_lag5_lag6_avg6
mcomisiones_otras_min6_lag2_lag4_lag5_lag6_tend6_avg3
mcuentas_saldo_min6_delta2_delta4
ctrx_quarter_max6_lag2_lag3_lag4_delta5_avg6
cliente_edad_avg3
mactivos_margen_max6_lag3_avg6_avg3
cliente_edad_avg6_lag2_lag3
mttarjeta_visa_debitos_automaticos_max6_lag2_lag3_lag4_lag5_lag6_avg6_avg3
mv_fultimo_cierre_avg6_delta2_lag3_delta4_avg3
Visa_cconsumos_avg6_delta2
ctarjeta_visa_transacciones_delta4_avg6
mrentabilidad_annual_min6_lag2_delta3_lag4_lag5_lag6_avg6_avg3
cliente_edad_lag4
mcuentas_saldo_min6_delta2_delta3_avg3
mrentabilidad_delta2_avg3
chomebanking_transacciones_max6_avg3
mactivos_margen_delta1_lag3_lag5
mactivos_margen_delta1_lag3_tend6
Visa_fultimo_cierre_avg6_lag2_lag3_avg3
ctrx_quarter_max6_lag2_delta3_tend6_avg3
Visa_fultimo_cierre_avg6_delta5_avg3
mprestamos_personales_delta4
ctrx_quarter_delta2_delta5_tend6
ccomisiones_otras_avg6_lag5_lag6_tend6
mv_cconsumos_avg3
mcaja_ahorro_dolares_max6_lag2_lag3_lag4
mpayroll_delta1
ctransferencias_recibidas_avg6_lag2_lag3_lag4_avg6_avg3
mvr_msaldopesos2_delta4_avg3
Visa_cconsumos_tend6
Visa_mpagominimo_max6_delta2_avg3
mrentabilidad_max6_delta4_tend6_avg3
mrentabilidad_max6_lag3_avg3
ccomisiones_otras_avg6_delta4_delta5_lag6_tend6_avg3
Visa_mpagospesos_max6_lag2_lag3_lag4_lag5_lag6
Visa_cconsumos_avg6_lag2_lag3_lag5_lag6
ctrx_quarter_max6_lag2_lag3_lag4_delta5_avg6_avg3
mcomisiones_otras_min6
mpasivos_margen_delta1_lag2_lag5
cpagomiscuentas_tend6_delta2_delta3
mrentabilidad_lag2_lag3
Visa_cconsumos_delta1_delta4_avg6
ccomisiones_mantenimiento_tend6_delta2_delta3_delta5_delta6_avg6
mttarjeta_visa_debitos_automaticos_max6_lag2_lag3_lag4_delta5_delta6_tend6_avg3
mactivos_margen_max6_lag6_avg6_avg3
cproductos_avg6_lag2_avg6_avg3
ccomisiones_otras_tend6_lag2_delta6_avg6_avg3
Visa_mpagominimo_max6_lag4_delta5_lag6_avg6
tcallcenter_avg6_avg3
mrentabilidad_avg6
ctransferencias_emitidas_max6_lag6_avg6_avg3
ccomisiones_otras_avg6_delta6_avg6_avg3
mactivos_margen_max6_lag3_lag6_avg6
mv_Fvencimiento_max6_lag2_lag3_avg3
mrentabilidad_max6_lag3
ctrx_quarter_tend6_lag2_lag3_lag4_lag5_lag6_avg6_avg3
mv_fechaalta_avg6_avg3
mcuenta_corriente_lag1_avg3
mcomisiones_otras_min6_lag2_avg6
cproductos_avg3
Visa_Fvencimiento_lag2_avg3
ctrx_quarter_min6_lag4_lag5_avg6
cmobile_app_trx_max6_delta4_tend6_avg3
mcuenta_corriente_min6_delta2_avg6_avg3
mv_fultimo_cierre_avg6_lag2_lag3_lag6_avg6
mcuenta_corriente_avg6_delta3_delta4_avg6
Visa_mpagospesos_max6_delta5_avg6
mv_fechaalta_avg6
chomebanking_transacciones_delta2_avg6
ctrx_quarter_max6_lag3_lag4_delta6_tend6_avg3
mcuentas_saldo_delta1_avg3
cmobile_app_trx_max6_lag6
mcomisiones_min6_lag2_lag3_lag4_lag5_lag6_avg6_avg3
mcuenta_corriente_min6_tend6
mtransferencias_recibidas_delta5_avg6
Visa_Fvencimiento_lag2
mv_fultimo_cierre_avg6_delta3_avg6_avg3
Visa_mconsumospesos_delta4
ctrx_quarter_min6_delta4_delta5_lag6_tend6_avg3
mactivos_margen_max6_lag2_lag3_lag5_lag6_avg3
mcomisiones_otras_min6_lag2_lag3_lag4_lag5_lag6_tend6
cliente_edad_lag1_lag2_lag3_lag5_lag6_avg3
Visa_mpagospesos_max6_lag2_lag3_lag4_lag5_delta6_avg6_avg3
Visa_msaldototal_avg3
mpasivos_margen_delta1_lag4_avg3
mcuenta_corriente_tend6_avg6_avg3
"
j <- strsplit(vector, "\\s")[[1]]


dataset  <- fread( "./datasets/canaproxy_vidapropia_03.csv.gz")

variables <- setdiff( colnames(dataset),  j )

dataset[  , c(variables) := NULL ]

fwrite( dataset, "./datasets/canaproxy_vidapropia_03_final.csv.gz" ,
        logical01 = TRUE,
        sep= "," )


